(()=>{"use strict";var t,e={458:(t,e,i)=>{function s(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}i.r(e),i.d(e,{default:()=>o});var o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),document.getElementById("resume-btn").addEventListener("click",e.resume),this.titleElement=document.getElementById("popup-screen-title")}var e,i;return e=t,(i=[{key:"printTitle",value:function(t){this.titleElement.innerText=t}},{key:"show",value:function(){document.querySelector(".popup-screen").classList.add("is-active")}},{key:"hide",value:function(){document.querySelector(".popup-screen").classList.remove("is-active")}}])&&s(e.prototype,i),Object.defineProperty(e,"prototype",{writable:!1}),t}()},798:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(i(386)),h=s(i(244)),n=s(i(458)),a=s(i(168));e.default=class{constructor(){this.hintText="Hello",this.animation=null,this.isAnimationRunning=!1,this.canvasElement=document.getElementById("screen"),this.canvasElement.width=window.innerWidth-10,this.canvasElement.height=window.innerHeight-10,this.screen=this.canvasElement.getContext("2d"),this.draw=this.draw.bind(this),this.resume=this.resume.bind(this),this.popupScreen=new n.default(this),this.objects=[],this.indicators=[],this.items=[],this.player=new h.default(this)}start(){this.objects.push(this.player),new o.default(this,this.player),this.items.push(new a.default(this)),this.draw()}draw(){this.deleteMarkedObjects(),null!==this.screen&&null!==this.canvasElement&&(this.screen.clearRect(0,0,this.canvasElement.width,this.canvasElement.height),this.objects.forEach((t=>t.move())),this.indicators.forEach((t=>t.draw())),this.items.forEach((t=>t.draw())),null!=this.hintText&&(this.screen.textAlign="center",this.screen.font="30px Arial",this.screen.fillText(this.hintText,this.player.position.left+this.player.width/2,this.player.position.top-100)),this.animation=requestAnimationFrame(this.draw),this.isAnimationRunning=!0)}deleteMarkedObjects(){const t=[];this.objects.forEach((e=>{e.markedForDeletion||t.push(e)})),this.objects=t;const e=[];this.indicators.forEach((t=>{t.markedForDeletion||e.push(t)})),this.indicators=e;const i=[];this.items.forEach((t=>{t.markedForDeletion||i.push(t)})),this.items=i}resume(){this.draw(),this.popupScreen.hide()}pause(){null!==this.animation?(cancelAnimationFrame(this.animation),this.isAnimationRunning=!1,this.popupScreen.show()):(console.log("Game can not be stopped"),console.log("animation was not stored"))}}},24:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(i(142));class h extends o.default{constructor(t,e,i,s){super(t),this.owner=e,this.range=i,this.color="red",s&&(this.color=s),this.setSize(this.owner.width+2*this.range,this.owner.height+2*this.range),this.setPosition(this.owner.position.left-this.range,this.owner.position.top-this.range)}setColor(t){this.color=t}setRange(t){this.range=t}update(){const t=this.owner.position.left-this.range,e=this.owner.position.top-this.range;this.setPosition(t,e)}draw(){this.update();const{screen:t}=this.game;t&&(t.strokeStyle=this.color,t.beginPath(),t.moveTo(this.getCoords().left,this.getCoords().top),t.lineTo(this.getCoords().right,this.getCoords().top),t.lineTo(this.getCoords().right,this.getCoords().bottom),t.lineTo(this.getCoords().left,this.getCoords().bottom),t.closePath(),t.stroke())}}e.default=h},315:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t=[]){this.ranges=t}add(t){Array.isArray(t)?t.forEach((t=>this.ranges.push(t))):this.ranges.push(t)}draw(){this.ranges.forEach((t=>t.draw()))}}},142:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(i(112));class h extends o.default{constructor(t){super(t)}}e.default=h},406:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(i(112)),h=i(928);class n extends o.default{constructor(t,e){super(t),this.id=Date.now()*Math.floor(100*Math.random()),this.player=e,this.flyRange=200,this.startCoord={top:e.direction.top,left:e.direction.left},this.flightDelta=0,this.moveVectorName=this.player.moveVectorName,this.height=10,this.width=10,this.speed=10,this.direction={top:0,left:0},this.setDirection(),this.position={top:0,left:0},this.setPosition(),this.damage=20}setDirection(){switch(this.player.getDirectionName()){case"left":this.direction.left=-1*this.speed,this.direction.top=0;break;case"right":this.direction.left=this.speed,this.direction.top=0;break;case"up":this.direction.top=-1*this.speed,this.direction.left=0;break;case"down":this.direction.top=1*this.speed,this.direction.left=0}}setPosition(){switch(this.player.getDirectionName()){case"left":this.position.top=this.player.getCoords().top+this.player.width/2-this.width/2+.8,this.position.left=this.player.getCoords().left-this.width;break;case"right":this.position.top=this.player.getCoords().top+this.player.width/2-this.width/2+.8,this.position.left=this.player.getCoords().right+this.width;break;case"up":this.position.top=this.player.getCoords().top-this.height,this.position.left=this.player.getCoords().left+this.player.width/2-this.width/2+.8;break;case"down":this.position.top=this.player.getCoords().bottom+this.height,this.position.left=this.player.getCoords().left+this.player.width/2-this.width/2+.8}this.startCoord={top:this.position.top,left:this.position.left}}measureFlightDelta(){let t=0;return t="left"===this.moveVectorName||"right"===this.moveVectorName?this.startCoord.left-this.position.left:this.startCoord.top-this.position.top,t<0&&(t*=-1),t}draw(){const{screen:t}=this.player.game;null!=t&&(t.fillStyle="black",t.fillRect(this.position.left,this.position.top,this.width,this.height))}move(){if(null!=this.player.game.canvasElement){const t=this.getCoords().top+this.direction.top,e=this.getCoords().left+this.direction.left,i=this.getCoords().bottom+this.direction.top,s=this.getCoords().right+this.direction.left;this.measureFlightDelta()>=this.flyRange&&this.die(),t>0&&i<this.player.game.canvasElement.height?this.position.top=t:this.die(),e>0&&s<this.player.game.canvasElement.width?this.position.left=e:this.die(),this.draw()}this.game.objects.forEach((t=>{t.isDamagable&&(0,h.checkColision)(this,t)&&(this.die(),t.getDamaged(this.damage))}))}}e.default=n},112:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=i(928),h=s(i(315));e.default=class{constructor(t){this.id=Date.now()*Math.floor(100*Math.random()),this.moveVectorName="up",this.position={top:0,left:0},this.height=10,this.width=10,this.markedForDeletion=!1,this.game=t,this.hp={full:100,available:100,lastTimeDamaged:0,timeWithoutDamage:3e3,healing:{speed:20,startedAt:0,startValue:0}},this.isDamagable=!1,this.type="neutral",this.actionRanges=new h.default,this.indicators=[]}heal(){const t=(0,o.getTimestamp)(),e=t-this.hp.lastTimeDamaged;if(this.hp.available<this.hp.full&&e>this.hp.timeWithoutDamage){0===this.hp.healing.startedAt&&(this.hp.healing.startedAt=t,this.hp.healing.startValue=this.hp.available);const e=t-this.hp.healing.startedAt;this.hp.available=this.hp.healing.startValue+e*this.hp.healing.speed/1e3}else this.hp.healing.startedAt=0;this.hp.available>=this.hp.full&&(this.hp.available=this.hp.full)}updateIndicators(){this.hp.indicator&&this.indicators.push(this.hp.indicator),this.gun&&this.indicators.push(this.gun.indicator)}getDirectionName(){return this.moveVectorName}getCoords(){return{top:this.position.top,left:this.position.left,bottom:this.position.top+this.height,right:this.position.left+this.width}}getDamaged(t){this.hp.available-=t,this.hp.lastTimeDamaged=(0,o.getTimestamp)(),this.hp.available<=0&&this.die()}die(){this.markedForDeletion=!0,this.indicators.forEach((t=>t.destroy()))}move(){}setSize(t,e){this.width=t,this.height=e}setPosition(t,e){this.position.left=t,this.position.top=e}}},453:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=i(928),h=s(i(406)),n=s(i(723));e.default=class{constructor(t,e){this.clipSize=3,this.bulletsInClip=3,this.shotRange=200,this.isReloading=!1,this.reloadingAnimation=null,this.remainingTime={min:300},this.reloadingTime={full:2e3,left:2e3,end:0},this.owner=e,this.lastShotTime=(0,o.getTimestamp)(),this.game=t,this.indicator=new n.default(t,e)}reload(){this.isReloading=!0,console.log("gun is reloading");const t=()=>{const e=(0,o.getTimestamp)();0===this.reloadingTime.end&&(this.reloadingTime.end=e+this.reloadingTime.full),this.reloadingTime.left=this.reloadingTime.end-e,this.reloadingTime.left<=0?(this.isReloading=!1,this.reloadingTime.end=0,this.bulletsInClip=this.clipSize,this.reloadingAnimation&&(cancelAnimationFrame(this.reloadingAnimation),this.reloadingAnimation=null),console.log("gun is ready to shot")):this.reloadingAnimation=requestAnimationFrame(t)};this.reloadingAnimation||(this.reloadingAnimation=requestAnimationFrame(t))}shot(){if(this.bulletsInClip>0){const t=(0,o.getTimestamp)();t-this.lastShotTime>this.remainingTime.min&&(this.owner.game.objects.push(new h.default(this.game,this.owner)),this.bulletsInClip-=1,this.lastShotTime=t)}else 0===this.bulletsInClip&&!1===this.isReloading&&this.reload()}}},241:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=i(928),h=s(i(112));class n extends h.default{constructor(t){super(t),this.speed=6,this.direction={top:0,left:0},this.isDamagable=!0,this.followTarget=null}turn(t){this.moveVectorName=t}setDirection(t,e=this.speed){switch(t){case"left":this.direction.left=-1*e,this.direction.top=0,this.turn("left");break;case"right":this.direction.left=e,this.direction.top=0,this.turn("right");break;case"up":this.direction.top=-1*e,this.direction.left=0,this.turn("up");break;case"down":this.direction.top=1*e,this.direction.left=0,this.turn("down")}}stop(){this.direction.left=0,this.direction.top=0}faceToTarget(t,e,i,s){t>i?this.turn("left"):t<i&&this.turn("right"),e>s?this.turn("up"):e<s&&this.turn("down")}setFollowTarget(t){this.followTarget?this.followTarget.obj=t:this.followTarget={obj:t,isLeftAligned:!1,isTopAligned:!1}}follow(t,e,i){if(this.followTarget||this.setFollowTarget(t),this.followTarget){const s=this.followTarget,h=t.position.top,n=t.position.left,a=this.position.top,r=this.position.left,l=(0,o.getModulus)(h-a),d=(0,o.getModulus)(n-r),c=e;l>0&&(s.isTopAligned=!1),d>0&&(s.isLeftAligned=!1);const u=()=>{s&&(l>c?a>h?this.setDirection("up"):a<h&&this.setDirection("down"):(s.isTopAligned=!0,this.direction.top=0,this.faceToTarget(r,a,n,h)))},p=()=>{s&&(d>c?r>n?this.setDirection("left"):r<n&&this.setDirection("right"):(s.isLeftAligned=!0,this.direction.left=0,this.faceToTarget(r,a,n,h)))},g=()=>{if(s)if(l>0){let t=this.speed;l<this.speed&&(t=l),a>h?this.setDirection("up",t):a<h&&this.setDirection("down",t)}else s.isTopAligned=!0,this.direction.top=0,this.faceToTarget(r,a,n,h)},f=()=>{if(s)if(d>0){let t=this.speed;d<this.speed&&(t=d),r>n?this.setDirection("left",t):r<n&&this.setDirection("right",t)}else s.isLeftAligned=!0,this.direction.left=0,this.faceToTarget(r,a,n,h)};l<=d&&(s.isTopAligned?p():g()),d<l&&(s.isLeftAligned?u():f()),s.isLeftAligned&&s.isTopAligned&&i()}}}e.default=n},244:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(i(241)),h=s(i(453)),n=s(i(734)),a=s(i(24)),r=s(i(912)),l=s(i(730)),d=i(928);class c extends o.default{constructor(t){super(t),this.game=t,this.height=50,this.width=50,null!==this.game.canvasElement&&(this.position={top:this.game.canvasElement.height/2-this.height/2,left:this.game.canvasElement.width/2-this.width/2}),this.speed=6,this.direction={top:0,left:0},this.gun=new h.default(t,this),this.hp.indicator=new n.default(t,this),this.moveVectorName="up",this.visibilityRange=new a.default(this.game,this,50,"blue"),this.actionRanges.add(this.visibilityRange),this.indicators.push(new r.default(this.game,this)),this.inventory=new l.default(this.game,this),this.around={objects:[],check:function(t){return this.objects.indexOf(t)>=0},add:function(t){this.check(t)||this.objects.push(t)},remove:function(t){if(this.check(t)){const e=this.objects.indexOf(t);this.objects.splice(e,1)}}},this.updateIndicators()}draw(){if(this.actionRanges.draw(),null!==this.game.screen){this.game.screen.fillStyle="red",this.game.screen.fillRect(this.position.left,this.position.top,this.width,this.height);const t=document.getElementById("player-direction-arrow"),e=this.height/t.height,i=i=>{null!==this.game.screen&&(this.game.screen.save(),this.game.screen.translate(this.position.left+this.width/2,this.position.top+this.height/2),this.game.screen.rotate(i*Math.PI/180),this.game.screen.fillStyle="blue",this.game.screen.drawImage(t,-1*this.width/2+8.5,-1*this.height/2,this.width*e,this.height),this.game.screen.restore())};switch(this.moveVectorName){case"left":i(-90);break;case"right":i(90);break;case"up":i(0);break;case"down":i(180)}}}move(){if(this.heal(),null!==this.game.canvasElement){const t=this.getCoords().top+this.direction.top,e=this.getCoords().left+this.direction.left,i=this.getCoords().bottom+this.direction.top,s=this.getCoords().right+this.direction.left;t>0&&i<this.game.canvasElement.height&&(this.position.top=t),e>=0&&s<this.game.canvasElement.width&&(this.position.left=e),this.game.items.forEach((t=>{(0,d.checkColision)(t,this.visibilityRange)?(this.game.hintText="Press 'e' to pick the item",this.around.add(t)):(this.game.hintText="",this.around.remove(t))})),0===this.game.items.length&&(this.game.hintText=""),this.draw()}}shoot(){this.gun.shot()}}e.default=c},723:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(i(21));class h extends o.default{constructor(t,e){super(t,e),this.marginToOwner=10,this.fillColor="#3FB0F0"}updateValue(t,e){this.target.gun&&(this.value={max:t,current:e},this.target.gun.isReloading&&(this.value.max=this.target.gun.reloadingTime.full,this.value.current=this.target.gun.reloadingTime.full-this.target.gun.reloadingTime.left))}update(){this.target.gun&&(this.updateValue(this.target.gun.clipSize,this.target.gun.bulletsInClip),this.updatePosition())}draw(){if(this.update(),this.game.screen&&this.target.gun){const{screen:t}=this.game;t.fillStyle="#D9D9D9",t.fillRect(this.position.left,this.position.top,this.width,this.height),t.fillStyle=this.fillColor,t.fillRect(this.position.left,this.position.top,this.value.current*this.width/this.value.max,this.height),t.strokeStyle="black",t.strokeRect(this.position.left,this.position.top,this.width,this.height);const{clipSize:e}=this.target.gun,i=this.width/e;for(let s=0;s<e;s++){const e=i*s;t.strokeRect(this.position.left+e,this.position.top,i,this.height)}}}}e.default=h},734:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(i(21));class h extends o.default{constructor(t,e){super(t,e),this.marginToOwner=20,this.fillColor="#EA6F6F"}update(){this.updateValue(this.target.hp.full,this.target.hp.available),this.updatePosition()}draw(){if(this.update(),this.game.screen){const{screen:t}=this.game;t.fillStyle="#D9D9D9",t.fillRect(this.position.left,this.position.top,this.width,this.height),t.fillStyle=this.fillColor,t.fillRect(this.position.left,this.position.top,this.value.current*this.width/this.value.max,this.height),t.strokeStyle="black",t.strokeRect(this.position.left,this.position.top,this.width,this.height),t.font="14px Arial",t.textAlign="center",t.fillText(""+Math.floor(this.target.hp.available),this.position.left+this.width/2,this.position.top-5)}}}e.default=h},21:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t,e){this.game=t,this.target=e,this.value={max:100,current:0},this.markedForDeletion=!1,this.height=10,this.width=80,this.marginToOwner=10,this.position={top:this.target.position.top+this.marginToOwner,left:(this.width-this.target.width)/2},this.fillColor="red",this.game.indicators.push(this),this.update()}updateValue(t,e){this.value={max:t,current:e}}updatePosition(){const t=(this.width-this.target.width)/2;this.position={top:this.target.position.top-(this.marginToOwner+this.height),left:this.target.position.left-t}}update(){}draw(){if(this.update(),this.game.screen){const{screen:t}=this.game;t.fillStyle="#D9D9D9",t.fillRect(this.position.left,this.position.top,this.width,this.height),t.fillStyle=this.fillColor,t.fillRect(this.position.left,this.position.top,this.value.current*this.width/this.value.max,this.height),t.strokeStyle="black",t.strokeRect(this.position.left,this.position.top,this.width,this.height)}}destroy(){this.markedForDeletion=!0}}},912:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(i(21));class h extends o.default{constructor(t,e){super(t,e),this.pageElement={available:document.getElementById("gun-prop-available"),full:document.getElementById("gun-prop-full")}}draw(){this.update(),this.target.gun&&(this.target.gun.isReloading?this.pageElement.available.innerText="Reloading....":(this.pageElement.available.innerText=""+this.target.gun.bulletsInClip,this.pageElement.full.innerText=""+this.target.gun.clipSize))}}e.default=h},730:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t,e){this.game=t,this.owner=e,this.items=[]}addItem(t){this.items.push(t)}show(){console.log("----INVENTORY---"),this.items.length>0?this.items.forEach((t=>console.log(t))):console.log("inventory is empty")}}},168:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(i(565));class h extends o.default{constructor(t){super(t),this.itemName="Bullet",this.amount=23,this.image=document.getElementById("inventory-item-bullets")}}e.default=h},565:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(i(112));class h extends o.default{constructor(t){super(t),this.game=t,this.itemName="Random item",this.amount=1,this.image=document.getElementById("inventory-item-random"),this.setPosition(200,200),this.setSize(30,30),this.game.objects.push(this)}draw(){const{screen:t}=this.game;t&&(this.image?(t.strokeStyle="brown",t.drawImage(this.image,this.position.left,this.position.top,this.width,this.height),t.strokeRect(this.position.left,this.position.top,this.width,this.height)):console.log("can not find image to draw inventory item called - "+this.itemName))}collect(t){t.around.remove(this),t.inventory.addItem(this),this.die()}}e.default=h},386:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t,e){function i(t){let e=t.key;return" "===e&&(e="Space"),e}let s;document.addEventListener("keydown",(o=>{const h=i(o);let n;switch(h){case"ArrowLeft":e.setDirection("left"),clearTimeout(s);break;case"ArrowRight":e.setDirection("right"),clearTimeout(s);break;case"ArrowUp":e.setDirection("up"),clearTimeout(s);break;case"ArrowDown":e.setDirection("down"),clearTimeout(s);break;case"Escape":t.isAnimationRunning?t.pause():t.resume();break;case"Space":e.shoot();break;case"p":n=t.objects.find((t=>"enemy"===t.type)),n.setTarget(e),console.log("target selected");break;case"o":n=t.objects.find((t=>"enemy"===t.type)),n.resetTarget(),console.log("target reseted");break;case"i":e.inventory.show();break;case"e":console.log(e.around.objects),e.around.objects.length>0&&e.around.objects[0].collect(e)}"Space"===h&&e.shoot()})),document.addEventListener("keyup",(t=>{s=setTimeout((()=>function(t){switch(i(t)){case"ArrowLeft":e.direction.left<0&&(e.direction.left=0);break;case"ArrowRight":e.direction.left>0&&(e.direction.left=0);break;case"ArrowUp":e.direction.top<0&&(e.direction.top=0);break;case"ArrowDown":e.direction.top>0&&(e.direction.top=0)}}(t)),85)}))}}},928:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.checkColision=e.getTimestamp=e.getTimestampInSeconds=e.getModulus=void 0,e.getModulus=function(t){return t>=0?t:-1*t},e.getTimestampInSeconds=function(){return Math.floor(Date.now()/1e3)},e.getTimestamp=function(){return Math.floor(Date.now())},e.checkColision=function(t,e){return t.getCoords().right>=e.getCoords().left&&t.getCoords().left<=e.getCoords().right&&t.getCoords().top<=e.getCoords().bottom&&t.getCoords().bottom>=e.getCoords().top}}},i={};function s(t){var o=i[t];if(void 0!==o)return o.exports;var h=i[t]={exports:{}};return e[t].call(h.exports,h,h.exports,s),h.exports}s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},s.d=(t,e)=>{for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),s.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},t=s(798),(new(s.n(t)())).start()})();